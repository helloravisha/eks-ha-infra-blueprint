
##  Affnity and AntiAffnity 

#### âœ… Affinity: "Place the pod here, if the node matches the label."
#### ğŸš« Anti-Affinity: "Do not place the pod here, if the node has a matching label."

âœŒï¸ Note for Anti affinity - When a pod is initially scheduled on a node, anti-affinity rules do not apply to it (since it's the first pod), and it can be scheduled on any node. Only subsequent pods that are being scheduled are affected by the anti-affinity rules.

```
affinity:
  podAntiAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      - labelSelector:
          matchLabels:
            app: encode-service
        topologyKey: kubernetes.io/hostname
```

##### requiredDuringSchedulingIgnoredDuringExecution , preferredDuringSchedulingIgnoredDuringExecution 
 âœŒï¸ Applies when pod is scheduled and not while pod is running. <br>
 âœŒï¸ <b>requiredDuringScheduling</b> - mandatroy for scheduling  , <b>preferredDuringScheduling</b> - not mandatroy for schduling 


## Taints and Tolerations 

```
spec:
  tolerations:
    - key: "critical"
      operator: "Equal"
      value: "true"
      effect: "NoSchedule"
```

The real difference between `NoSchedule`, `PreferNoSchedule`, and `NoExecute` only shows up **when the pod does not have a matching toleration**.

### ğŸŸ¥ NoSchedule
- **No toleration?** â†’ ğŸš« Pod will **never** be scheduled on that node.
- **With toleration?** â†’ âœ… scheduled.

### ğŸŸ§ PreferNoSchedule
- **No toleration?** â†’ ğŸ˜• Scheduler **tries to avoid** this node, but **may schedule** it anyway if no better options.
- **With toleration?** â†’ âœ… scheduled.

### â¬› NoExecute
- **No toleration?** â†’ ğŸš« Pod will be **evicted** from the node if it's already running there and will not be scheduled there again.
- **With toleration?** â†’ âœ… scheduled.

> ğŸ’¡ You can even say: â€œStay for 60 seconds and then get evictedâ€ using `tolerationSeconds`.





 
